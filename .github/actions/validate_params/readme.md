# SWiG parameter validation
## Usage
* Install python
* Install libraries from requirements.txt, e.g. using `pip -r ./requirements.txt`
* Run `python .\.github\actions\validate_params\validate_params.py -h` for usage instructions and options for autogenerated output files
* Run `python .\.github\actions\validate_params\validate_params.py --file .\parameters.json --schema .\parameters_schema.json` from the top level of the repository clone to test the files before submitting them

The script is run automatically by a github workflow if the validated files or test configuration are changed. On a pull request, the parameters are validated against the schema. When pushed, the parameters are validated and autogenerated ouptut files (CSV, protobuf) are generated and committed

## Producing PR comment
The script output is in github compatible markdown format to form a report which could be inserted into the PR. To do that, redirect the python script output to a file (appending ` | tee validation.txt` to the python script call in `workflows\verify_params.yml`) and insert the file in the corresponding PR as a comment e.g.:

```
- name: Comment on PR with script output
  uses: thollander/actions-comment-pull-request@v3
  with:
    message: |
      ```
      $(cat output.txt)
      ```
  env:
    GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
```

Note job permissions required PR write access:
```
permissions:
  pull-requests: write
```